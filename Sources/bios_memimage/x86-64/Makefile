
include ../mk.64

OBJS=	start.o page.o long.o bios_generic.o bios_pxe.o bios_disk.o pxecall.o
OBJS+=	bcopy.o mapmem.o

CFLAGS= -ffreestanding -Os -I../include -Wall -march=x86-64
CFLAGS32= -Os -I../include -march=i386

ASFLAGS= -I../include

libx86-64.a: $(OBJS)
	$(AR) rcs libx86-64.a $(OBJS)

page.S: page_tables.c
	rm -f page.S
	cc $(CFLAGS32) -S -o page.s page_tables.c
	echo "/* This file is autogenerated from page_tables.c. */" > page.S
	echo ".code32" >> page.S
	cat page.s >> page.S
	rm -f page.s

clean:
	/bin/rm -f *.o libx86-64.a

